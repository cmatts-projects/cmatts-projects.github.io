{"version":3,"sources":["components/state/actions/Types.js","components/state/actions/TreeActions.js","components/datasource/Comparitor.js","components/datasource/Datasource.js","components/state/actions/DetailsActions.js","components/datasource/DataTypes.js","components/presentation/Search.js","components/presentation/Heading.js","components/state/actions/SearchActions.js","components/state/actions/DataRepositoryActions.js","components/presentation/ScrollWindow.js","components/presentation/charts/AncestryCoverage.js","components/presentation/charts/NameConsolidation.js","components/presentation/charts/DataAnalysis.js","components/presentation/charts/NameFrequency.js","components/presentation/charts/OriginMap.js","components/presentation/AnalysisView.js","components/presentation/Person.js","components/presentation/Siblings.js","components/presentation/TreeNode.js","components/presentation/Gallery.js","components/presentation/Details.js","components/presentation/TreeView.js","components/presentation/FamilyTree.js","components/ErrorBoundary.js","components/state/reducers/DataRepositoryReducer.js","components/state/reducers/TreeReducer.js","components/state/reducers/DetailsReducer.js","components/state/reducers/SearchReducer.js","components/state/reducers/index.js","components/state/Store.js","components/App.js","index.js"],"names":["setGalleryIndex","index","type","data","setGalleryScale","scale","changeRoot","rootId","dispatch","setRoot","Comparitor","constructor","field","compare","a","b","undefined","this","findPerson","state","id","dataRepository","people","findPeople","slice","sort","findFacts","result","fact","facts","person_id","push","findPlace","place","places","shareFather","person1","person2","father","mother","shareMother","mapHalfByFather","halfByFather","person","grpByMother","j","length","mapHalfByMother","halfByMother","grpByFather","findSiblings","child","parents","fullSiblings","i","concat","sortByBirth","map","grp","loadData","onLoaded","sourceFile","XMLHttpRequest","open","responseType","onload","binaryString","response","Uint8Array","arr","String","fromCharCode","join","toBinaryString","workbook","XLSX","read","worksheetPeople","Sheets","utils","sheet_to_json","raw","parseInt","updatePeopleIds","worksheetFacts","worksheetPlaces","indexedPlaces","send","placesArray","getResourceUrl","url","showPerson","getState","datasource","firstResource","getFirstResource","currentResource","currentFact","galleryItems","items","src","caption","getGalleryItems","setDisplayedDetails","personId","toggleGallery","detailsState","details","galleryIndex","showGallery","currentGalleryIndex","item","PropTypes","shape","name","string","number","yearOfBirth","yearOfDeath","year","Search","React","Component","arguments","renderYear","renderMenuItemChildren","options","props","createElement","Highlighter","key","search","text","onChange","selection","render","Typeahead","placeholder","minLength","selectHintOnEnter","labelKey","connect","Heading","showTree","changeView","showAnalysis","Navbar","className","NavbarBrand","onClick","alt","Nav","navbar","UncontrolledDropdown","nav","DropdownToggle","height","width","DropdownMenu","right","DropdownItem","view","setView","dataReady","searchOptions","ScrollWindow","super","scrollTo","scrollAttr","max","acceleration","isX","scroll","refElement","onMouseMove","event","isMouseDown","lastMousePositionX","lastMousePositionY","privateState","scrollAttrX","eventMoveX","scrollAttrY","eventMoveY","setPrivateState","onMouseUp","startTime","positionStartX","positionStartY","time","Date","distanceX","velocityX","Math","round","accelerationX","distanceY","velocityY","accelerationY","provisionOnMouseDown","animation","clearTimeout","provisionRef","element","clearListeners","scrollLengthW","scrollOffsetW","scrollLengthH","scrollOffsetH","addEventListenerWithClear","func","addEventListener","clear","removeListenerFactory","eventName","listener","removeEventListener","componentDidMount","componentWillUnmount","forEach","maxW","maxH","setTimeout","ref","onMouseDown","Children","children","only","defaultProps","AncestryCoverage","anchor","colourMap","rootChange","renderPopup","d","padSingleMother","node","parent","size","x1","x0","shiftNodes","drawAncestorChart","root","partition","radius","drawArc","defineArcFn","each","current","svgSunburst","createSvg","ancestorGraphics","addAncestorGraphics","path","addPathGraphics","addParentGraphic","zoomEvent","zoomFn","addPathPopup","addParentPopup","addParentClick","addPathClick","p","datum","target","min","PI","y0","depth","y1","transitionAni","transition","duration","tween","d3","t","attrTween","updateParentPopup","clicked","filter","style","on","selectName","surname","selectPlace","origin","append","attr","select","selectAll","bisect","maxHeight","value","pow","arc","startAngle","endAngle","padRadius","innerRadius","outerRadius","NameConsolidation","nameFreq","Object","entries","reduce","acc","curr","quantity","variant","nameVariant","consolidatedName","processed","matches","processedName","levenshteinDistance","name1","name2","len1","len2","matrix","Array","array","boolean","DataAnalysis","split","personTreeData","parentData","getParentData","getData","names","populateNames","nameFrequency","calcFrequency","consolidatedNameFreq","consolidate","sortDataTable","createDataTable","namesData","origins","populateOrigins","originFrequency","NameFrequency","selectCallback","margin","top","bottom","left","drawNameChart","nameData","extractNameData","namesHeight","addNamesGraphics","calcXScale","calcYScale","addAxisGraphics","drawEntryBars","xScale","domain","range","yScale","padding","drawBars","svg","enter","popup","redrawChart","redrawNameChart","newData","hideAdditionalBars","merge","newDataSize","xAxis","remove","yAxis","svgBase","xScaleOverride","x","y","bandwidth","tickNumber","call","ticks","tickFormat","OriginMap","drawOriginChart","projection","mapProjection","addMapGraphics","drawRegions","drawBoundaries","drawPlaceNames","originData","extractOriginData","drawOrigins","redrawOriginChart","newOriginData","newOriginDataItem","long","lat","center","rotate","parallels","translate","regionData","topojson","uk","objects","subunits","regionColour","SCT","WLS","NIR","ENG","IRL","features","drawRegionNames","centroid","properties","plotted","geometry","coordinates","clash","detectLabelClash","plot","abs","AnalysisView","nameFrequencyChart","ancestryCoverage","originMap","originMapChart","ancestryCoverageChart","Container","fluid","Row","Col","sm","el","tree","Person","renderLifespan","lifespan","divId","Siblings","renderPerson","renderHalfByFather","siblings","group","xs","renderChildren","renderHalfByMother","renderFullSiblings","enablePopover","keys","UncontrolledPopover","placement","trigger","delay","PopoverBody","mapStateToProps","ownProps","TreeNode","selectPerson","SubTreeNode","Gallery","carouselItems","CarouselItem","galleryScale","draggable","CarouselCaption","captionText","renderButtons","selectGalleryScalePlus","selectGalleryScaleMinus","Modal","isOpen","external","contentClassName","ModalBody","Carousel","activeIndex","next","selectGalleryNext","previous","selectGalleryPrev","interval","CarouselIndicators","onClickHandler","selectGalleryIndex","CarouselControl","direction","directionText","Details","renderFacts","factIndex","selectResourcePreview","renderPreview","UncontrolledTooltip","setResourcePreview","resource","TreeView","FamilyTree","headerHeight","headerElement","createRef","resizeHandler","bind","clientHeight","setState","componentDidUpdate","window","dataLoaded","href","rel","getFullYear","ErrorBoundary","error","info","componentDidCatch","lg","initialState","combineReducers","action","middleware","thunk","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","trace","traceLimit","compose","store","createStore","rootReducer","applyMiddleware","App","Provider","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.fbe3f772.chunk.js","sourcesContent":["export const DATA_LOADED = 'DATA_LOADED';\nexport const SET_ROOT = 'SET_ROOT';\nexport const SET_VIEW = 'SET_VIEW';\nexport const SET_DISPLAYED_DETAILS = 'SET_DISPLAYED_DETAILS';\nexport const SET_RESOURCE_PREVIEW = 'SET_RESOURCE_PREVIEW';\nexport const GALLERY_TOGGLED = 'GALLERY_TOGGLED';\nexport const SET_GALLERY_INDEX = 'SET_GALLERY_INDEX';\nexport const SET_GALLERY_SCALE = 'SET_GALLERY_SCALE';\nexport const SEARCH_OPTIONS = 'SEARCH_OPTIONS';\n\nexport const dataLoaded = (people, facts, places) => ({\n    type: DATA_LOADED,\n    data: {\n        people: people,\n        facts: facts,\n        places: places\n    }\n});\n\nexport const setRoot = rootId => ({\n    type: SET_ROOT,\n    data: {\n        rootId: rootId\n    }\n});\n\nexport const setView = view => ({\n    type: SET_VIEW,\n    data: {\n        view: view\n    }\n});\n\nexport const setDisplayedDetails = (\n    id,\n    person,\n    facts,\n    currentResource,\n    currentFact,\n    galleryItems\n) => ({\n    type: SET_DISPLAYED_DETAILS,\n    data: {\n        personId: id,\n        person: person,\n        facts: facts,\n        currentResource: currentResource,\n        currentFact: currentFact,\n        galleryItems: galleryItems\n    }\n});\n\nexport const setResourcePreview = (resource, fact) => ({\n    type: SET_RESOURCE_PREVIEW,\n    data: {\n        resource: resource,\n        fact: fact\n    }\n});\n\nexport const galleryToggled = index => ({\n    type: GALLERY_TOGGLED,\n    data: {\n        index: index\n    }\n});\n\nexport const setGalleryIndex = index => ({\n    type: SET_GALLERY_INDEX,\n    data: {\n        index: index\n    }\n});\n\nexport const setGalleryScale = scale => ({\n    type: SET_GALLERY_SCALE,\n    data: {\n        scale: scale\n    }\n});\n\nexport const searchOptions = options => ({\n    type: SEARCH_OPTIONS,\n    data: {\n        options: options\n    }\n});\n","import { setRoot, setView } from './Types';\n\nexport const changeRoot = rootId => dispatch => {\n    dispatch(setRoot(rootId));\n};\n\nexport const changeView = view => dispatch => {\n    dispatch(setView(view));\n};\n","export default class Comparitor {\n    constructor(field) {\n        this.field = field;\n    }\n\n    compare = (a, b) => {\n        return b[this.field] === undefined || a[this.field] > b[this.field]\n            ? 1\n            : a[this.field] < b[this.field]\n            ? -1\n            : a[this.field] === undefined\n            ? -1\n            : 0;\n    };\n}\n","import XLSX from 'xlsx';\nimport Comparitor from './Comparitor';\n\nconst toBinaryString = response => {\n    let data = new Uint8Array(response);\n    let arr = [];\n    for (let i = 0; i !== data.length; ++i) {\n        arr[i] = String.fromCharCode(data[i]);\n    }\n\n    return arr.join('');\n};\n\nconst updatePeopleIds = people => {\n    for (const id in people) {\n        people[id].id = parseInt(id) + 2;\n    }\n};\n\nclass Datasource {\n    findPerson(state, id) {\n        if (!id) {\n            return null;\n        }\n        return state.dataRepository.people[id - 2];\n    }\n\n    findPeople(state) {\n        return state.dataRepository.people\n            .slice(0)\n            .sort(new Comparitor('name').compare);\n    }\n\n    findFacts(state, id) {\n        if (!id) {\n            return null;\n        }\n\n        let result = [];\n        for (const fact of state.dataRepository.facts) {\n            if (fact.person_id === id) {\n                result.push(fact);\n            }\n        }\n\n        result = result.sort(new Comparitor('year').compare);\n\n        return result;\n    }\n\n    findPlace(state, place) {\n        if (!place) {\n            return null;\n        }\n        return state.dataRepository.places[place];\n    }\n\n    shareFather(person1, person2) {\n        return (\n            (person2.father && person2.father === person1.father) ||\n            (!person1.father &&\n                !person2.father &&\n                person2.mother &&\n                person2.mother === person1.mother)\n        );\n    }\n\n    shareMother(person1, person2) {\n        return (\n            (person2.mother && person2.mother === person1.mother) ||\n            (!person1.mother &&\n                !person2.mother &&\n                person2.father &&\n                person2.father === person1.father)\n        );\n    }\n\n    mapHalfByFather(halfByFather, person) {\n        let grpByMother;\n        for (let j = 0; j < halfByFather.length; j++) {\n            if (halfByFather[j][0].mother === person.mother) {\n                grpByMother = halfByFather[j];\n            }\n        }\n\n        if (!grpByMother) {\n            grpByMother = [];\n            halfByFather.push(grpByMother);\n        }\n\n        grpByMother.push(person);\n    }\n\n    mapHalfByMother(halfByMother, person) {\n        let grpByFather;\n        for (let j = 0; j < halfByMother.length; j++) {\n            if (halfByMother[j][0].father === person.father) {\n                grpByFather = halfByMother[j];\n            }\n        }\n\n        if (!grpByFather) {\n            grpByFather = [];\n            halfByMother.push(grpByFather);\n        }\n        grpByFather.push(person);\n    }\n\n    findSiblings(state, id) {\n        let child = this.findPerson(state, id);\n\n        let parents = {};\n        let fullSiblings = [];\n        let halfByFather = [];\n        let halfByMother = [];\n\n        for (let i = 0; i < state.dataRepository.people.length; i++) {\n            let person = this.findPerson(state, i + 2);\n            let shareFather = this.shareFather(child, person);\n            let shareMother = this.shareMother(child, person);\n\n            if (shareFather && shareMother) {\n                fullSiblings.push(person);\n            } else if (shareFather) {\n                this.mapHalfByFather(halfByFather, person);\n            } else if (shareMother) {\n                this.mapHalfByMother(halfByMother, person);\n            }\n\n            if (shareFather || shareMother) {\n                if (person.father && !parents[person.father]) {\n                    parents[`parent_${person.father}`] = this.findPerson(\n                        state,\n                        person.father\n                    );\n                }\n                if (person.mother && !parents[person.mother]) {\n                    parents[`parent_${person.mother}`] = this.findPerson(\n                        state,\n                        person.mother\n                    );\n                }\n            }\n        }\n\n        const sortByBirth = new Comparitor('yearOfBirth').compare;\n        fullSiblings = fullSiblings.sort(sortByBirth);\n        halfByFather = halfByFather.map(grp => grp.sort(sortByBirth));\n        halfByMother = halfByMother.map(grp => grp.sort(sortByBirth));\n\n        return {\n            fullSiblings: fullSiblings,\n            halfByFather: halfByFather,\n            halfByMother: halfByMother,\n            parents: parents\n        };\n    }\n\n    loadData(onLoaded) {\n        const dataFile = './FamilyTreeDB.xlsx';\n        const sourceFile = new XMLHttpRequest();\n\n        sourceFile.open('GET', dataFile, true);\n        sourceFile.responseType = 'arraybuffer';\n        sourceFile.onload = () => {\n            const binaryString = toBinaryString(sourceFile.response);\n            const workbook = XLSX.read(binaryString, { type: 'binary' });\n\n            const worksheetPeople = workbook.Sheets['people'];\n            const people = XLSX.utils.sheet_to_json(worksheetPeople, {\n                raw: true\n            });\n\n            updatePeopleIds(people);\n\n            const worksheetFacts = workbook.Sheets['facts'];\n            const facts = XLSX.utils.sheet_to_json(worksheetFacts, {\n                raw: true\n            });\n\n            const worksheetPlaces = workbook.Sheets['places'];\n            const places = this.indexedPlaces(\n                XLSX.utils.sheet_to_json(worksheetPlaces, {\n                    raw: true\n                })\n            );\n\n            if (onLoaded) {\n                onLoaded(people, facts, places);\n            }\n        };\n        sourceFile.send();\n    }\n\n    indexedPlaces(placesArray) {\n        const places = [];\n        for (const index in placesArray) {\n            places[placesArray[index].place] = placesArray[index];\n        }\n        return places;\n    }\n}\n\nexport default new Datasource();\n","import {\n    setDisplayedDetails,\n    setResourcePreview,\n    galleryToggled,\n    setGalleryIndex,\n    setGalleryScale\n} from './Types';\nimport datasource from '../../datasource/Datasource';\n\nconst MAX_SCALE_SIZE = 5;\n\nconst getFirstResource = facts => {\n    if (facts && facts.length > 0) {\n        for (let index = 0; index < facts.length; index++) {\n            if (facts[index].url && facts[index].url.length > 0) {\n                return index;\n            }\n        }\n    }\n    return -1;\n};\n\nconst getResourceUrl = url => {\n    if (url && url.length > 0) {\n        return `resources/${url}`;\n    }\n    return 'images/no-image-available-icon-6.gif';\n};\n\nconst getGalleryItems = facts => {\n    let items = null;\n\n    if (facts && facts.length > 0) {\n        items = [];\n        for (let fact of facts) {\n            if (fact.url && fact.url.length > 0) {\n                items.push({\n                    src: getResourceUrl(fact.url),\n                    caption: fact.fact\n                });\n            }\n        }\n    }\n\n    return items;\n};\n\nconst currentGalleryIndex = (currentResource, items) => {\n    let index = 0;\n    for (let item of items) {\n        if (item.src === currentResource) {\n            return index;\n        }\n        index++;\n    }\n    return 0;\n};\n\nexport const showPerson = id => (dispatch, getState) => {\n    let person = datasource.findPerson(getState(), id);\n    let facts = datasource.findFacts(getState(), id);\n    let firstResource = getFirstResource(facts);\n    let currentResource = null;\n    let currentFact = null;\n    let galleryItems = getGalleryItems(facts);\n\n    if (firstResource > -1) {\n        currentResource = getResourceUrl(facts[firstResource].url);\n        currentFact = facts[firstResource].fact;\n    }\n\n    dispatch(\n        setDisplayedDetails(\n            id,\n            person,\n            facts,\n            currentResource,\n            currentFact,\n            galleryItems\n        )\n    );\n};\n\nexport const selectResourcePreview = factIndex => (dispatch, getState) => {\n    const facts = getState().details.facts;\n    let resource = getResourceUrl(facts[factIndex].url);\n    let fact = facts[factIndex].fact;\n\n    dispatch(setResourcePreview(resource, fact));\n};\n\nexport const toggleGallery = () => (dispatch, getState) => {\n    const detailsState = getState().details;\n    const galleyShowing = detailsState.showGallery;\n    let galleryIndex = null;\n    if (!galleyShowing) {\n        galleryIndex = currentGalleryIndex(\n            detailsState.currentResource,\n            detailsState.galleryItems\n        );\n    }\n    dispatch(galleryToggled(galleryIndex));\n};\n\nexport const selectGalleryNext = () => (dispatch, getState) => {\n    const detailsState = getState().details;\n    let index =\n        detailsState.galleryIndex === detailsState.galleryItems.length - 1\n            ? 0\n            : detailsState.galleryIndex + 1;\n\n    dispatch(setGalleryIndex(index));\n};\n\nexport const selectGalleryPrev = () => (dispatch, getState) => {\n    const detailsState = getState().details;\n    let index =\n        detailsState.galleryIndex === 0\n            ? detailsState.galleryItems.length - 1\n            : detailsState.galleryIndex - 1;\n\n    dispatch(setGalleryIndex(index));\n};\n\nexport const selectGalleryIndex = index => dispatch => {\n    dispatch(setGalleryIndex(index));\n};\n\nexport const selectGalleryScalePlus = scale => (dispatch, getState) => {\n    const detailsState = getState().details;\n    let scale =\n        detailsState.galleryScale === MAX_SCALE_SIZE\n            ? 0\n            : detailsState.galleryScale + 1;\n\n    dispatch(setGalleryScale(scale));\n};\n\nexport const selectGalleryScaleMinus = scale => (dispatch, getState) => {\n    const detailsState = getState().details;\n    let scale =\n        detailsState.galleryScale === 0\n            ? MAX_SCALE_SIZE\n            : detailsState.galleryScale - 1;\n\n    dispatch(setGalleryScale(scale));\n};\n","import PropTypes from 'prop-types';\n\nexport const personType = PropTypes.shape({\n    name: PropTypes.string,\n    father: PropTypes.number,\n    mother: PropTypes.number,\n    yearOfBirth: PropTypes.number,\n    yearOfDeath: PropTypes.number,\n    id: PropTypes.number\n});\n\nexport const factType = PropTypes.shape({\n    person_id: PropTypes.number,\n    year: PropTypes.string,\n    url: PropTypes.string,\n    src: PropTypes.string,\n    fact: PropTypes.string\n});\n","import React from 'react';\nimport { Typeahead, Highlighter } from 'react-bootstrap-typeahead';\nimport 'react-bootstrap-typeahead';\nimport { connect } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport { changeRoot } from '../state/actions/TreeActions';\nimport { showPerson } from '../state/actions/DetailsActions';\nimport { personType } from '../datasource/DataTypes';\n\nexport class Search extends React.Component {\n    renderYear = year => {\n        return year ? year : '?';\n    };\n\n    renderMenuItemChildren = (options, props, index) => {\n        return [\n            <Highlighter key=\"name\" search={props.text}>\n                {options.name}\n            </Highlighter>,\n            <small key=\"lifespan\">\n                &nbsp;({this.renderYear(options.yearOfBirth)} -{' '}\n                {this.renderYear(options.yearOfDeath)})\n            </small>\n        ];\n    };\n\n    onChange = selection => {\n        if (selection[0]) {\n            this.props.showPerson(selection[0].id);\n            this.props.changeRoot(selection[0].id);\n        }\n    };\n\n    render() {\n        return (\n            <div>\n                <Typeahead\n                    id=\"searchAncestors\"\n                    options={this.props.options}\n                    placeholder=\"Start typing ancestor name...\"\n                    minLength={3}\n                    selectHintOnEnter={true}\n                    renderMenuItemChildren={this.renderMenuItemChildren}\n                    labelKey=\"name\"\n                    onChange={this.onChange}\n                />\n            </div>\n        );\n    }\n}\n\nSearch.propTypes = {\n    changeRoot: PropTypes.func.isRequired,\n    showPerson: PropTypes.func.isRequired,\n    options: PropTypes.arrayOf(personType)\n};\n\nconst mapStateToProps = state => ({\n    options: state.search.options\n});\n\nexport default connect(mapStateToProps, { changeRoot, showPerson })(Search);\n","import React from 'react';\nimport {\n    DropdownItem,\n    DropdownMenu,\n    DropdownToggle,\n    UncontrolledDropdown,\n    Nav,\n    Navbar,\n    NavbarBrand\n} from 'reactstrap';\nimport Search from './Search';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { changeRoot, changeView } from '../state/actions/TreeActions';\nimport { showPerson } from '../state/actions/DetailsActions';\n\nexport class Heading extends React.Component {\n    changeRoot = () => {\n        const defaultRootId = 2;\n        this.props.showPerson();\n        this.props.changeRoot(defaultRootId);\n    };\n\n    showTree = () => {\n        this.props.changeView('TREE');\n    };\n\n    showAnalysis = () => {\n        this.props.changeView('ANALYSIS');\n    };\n\n    render() {\n        return (\n            <div>\n                <Navbar className=\"heading\">\n                    <NavbarBrand onClick={this.changeRoot}>\n                        <img\n                            className=\"titleImage\"\n                            src=\"./images/title.gif\"\n                            alt=\"Home\"\n                        />\n                    </NavbarBrand>\n\n                    <span className=\"ml-auto\">\n                        <Search />\n                    </span>\n                    <Nav navbar>\n                        <UncontrolledDropdown nav>\n                            <DropdownToggle nav>\n                                <img\n                                    src=\"./images/menu.svg\"\n                                    height={40}\n                                    width={40}\n                                    alt=\"Options\"\n                                />\n                            </DropdownToggle>\n                            <DropdownMenu right>\n                                <DropdownItem\n                                    onClick={this.showTree}\n                                    className=\"showTree\"\n                                >\n                                    <img\n                                        src=\"./images/tree.svg\"\n                                        height={40}\n                                        width={40}\n                                        alt=\"Tree View\"\n                                    />\n                                    Tree View\n                                </DropdownItem>\n                                <DropdownItem\n                                    onClick={this.showAnalysis}\n                                    className=\"showAnalysis\"\n                                >\n                                    <img\n                                        src=\"./images/analysis.svg\"\n                                        height={40}\n                                        width={40}\n                                        alt=\"Analysis View\"\n                                    />\n                                    Analysis View\n                                </DropdownItem>\n                            </DropdownMenu>\n                        </UncontrolledDropdown>\n                    </Nav>\n                </Navbar>\n            </div>\n        );\n    }\n}\n\nHeading.propTypes = {\n    changeView: PropTypes.func.isRequired,\n    changeRoot: PropTypes.func.isRequired,\n    showPerson: PropTypes.func.isRequired\n};\n\nexport default connect(null, { changeView, changeRoot, showPerson })(Heading);\n","import { searchOptions } from './Types';\nimport datasource from '../../datasource/Datasource';\n\nexport const populateSearchOptions = () => (dispatch, getState) => {\n    const options = datasource.findPeople(getState());\n\n    dispatch(searchOptions(options));\n};\n","import { dataLoaded } from './Types';\nimport datasource from '../../datasource/Datasource';\nimport { populateSearchOptions } from './SearchActions';\n\nexport const loadData = () => dispatch => {\n    datasource.loadData((people, facts, places) => {\n        dispatch(dataLoaded(people, facts, places));\n        dispatch(dataReady());\n    });\n};\n\nexport const dataReady = () => dispatch => {\n    dispatch(populateSearchOptions());\n};\n","/*eslint no-restricted-globals: 0*/\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nexport default class ScrollWindow extends React.Component {\n    constructor(props) {\n        super(props);\n        this.privateState = {\n            isMouseDown: false,\n            lastMousePositionX: null,\n            lastMousePositionY: null,\n            startTime: null\n        };\n        this.refElement = null;\n        this.clearListeners = [];\n\n        this.scrollAttrX = 'scrollLeft';\n        this.eventMoveX = 'clientX';\n        this.scrollLengthW = 'scrollWidth';\n        this.scrollOffsetW = 'offsetWidth';\n\n        this.scrollAttrY = 'scrollTop';\n        this.eventMoveY = 'clientY';\n        this.scrollLengthH = 'scrollHeight';\n        this.scrollOffsetH = 'offsetHeight';\n    }\n\n    setPrivateState(state) {\n        this.privateState = { ...this.privateState, ...state };\n    }\n\n    addEventListenerWithClear(type, func) {\n        this.refElement.addEventListener(type, func);\n        const clear = this.removeListenerFactory(type, func);\n        this.clearListeners.push(clear);\n    }\n\n    removeListenerFactory(eventName, listener) {\n        return () => removeEventListener(eventName, listener);\n    }\n\n    componentDidMount() {\n        this.addEventListenerWithClear('mouseup', this.onMouseUp);\n        this.addEventListenerWithClear('mouseleave', this.onMouseUp);\n        this.addEventListenerWithClear('mousemove', this.onMouseMove);\n    }\n\n    componentWillUnmount() {\n        this.clearListeners.forEach(clear => clear());\n    }\n\n    scroll(accelerationX, accelerationY) {\n        const maxW =\n            this.refElement[this.scrollLengthW] -\n            this.refElement[this.scrollOffsetW];\n        const maxH =\n            this.refElement[this.scrollLengthH] -\n            this.refElement[this.scrollOffsetH];\n\n        this.animation = setTimeout(() => {\n            scrollTo(this.scrollAttrX, maxW, accelerationX, true);\n            scrollTo(this.scrollAttrY, maxH, accelerationY, false);\n        }, 10);\n    }\n\n    scrollTo = (scrollAttr, max, acceleration, isX) => {\n        const scroll = this.refElement[scrollAttr];\n        if (scroll !== 0 && scroll !== max && acceleration !== 0) {\n            this.refElement[this.scrollAttr] += acceleration;\n            acceleration =\n                acceleration > 0 ? acceleration - 1 : acceleration + 1;\n            if (isX) {\n                this.scroll(acceleration, 0);\n            } else {\n                this.scroll(0, acceleration);\n            }\n        }\n    };\n\n    onMouseMove = event => {\n        const {\n            isMouseDown,\n            lastMousePositionX,\n            lastMousePositionY\n        } = this.privateState;\n        if (!isMouseDown) {\n            return null;\n        }\n\n        if (\n            this.refElement === null ||\n            lastMousePositionX === null ||\n            lastMousePositionY === null\n        ) {\n            return null;\n        }\n\n        this.refElement[this.scrollAttrX] +=\n            lastMousePositionX - event[this.eventMoveX];\n\n        this.refElement[this.scrollAttrY] +=\n            lastMousePositionY - event[this.eventMoveY];\n\n        this.setPrivateState({\n            lastMousePositionX: event[this.eventMoveX],\n            lastMousePositionY: event[this.eventMoveY]\n        });\n    };\n\n    onMouseUp = () => {\n        const { startTime, positionStartX, positionStartY } = this.privateState;\n        const time = (new Date() - startTime) / 1000;\n\n        const positionEndX = this.refElement[this.scrollAttrX];\n        const distanceX = positionEndX - positionStartX;\n        const velocityX = Math.round(distanceX / time);\n        const accelerationX = Math.round(velocityX / time / 100);\n\n        const positionEndY = this.refElement[this.scrollAttrY];\n        const distanceY = positionEndY - positionStartY;\n        const velocityY = Math.round(distanceY / time);\n        const accelerationY = Math.round(velocityY / time / 100);\n\n        this.setPrivateState({\n            isMouseDown: false,\n            lastMousePositionX: null,\n            lastMousePositionY: null,\n            time\n        });\n        this.scroll(accelerationX, accelerationY);\n    };\n\n    provisionOnMouseDown = event => {\n        if (this.animation) {\n            clearTimeout(this.animation);\n        }\n        this.setPrivateState({\n            isMouseDown: true,\n            lastMousePositionX: event[this.eventMoveX],\n            lastMousePositionY: event[this.eventMoveY],\n            startTime: new Date(),\n            positionStartX: this.refElement[this.scrollAttrX],\n            positionStartY: this.refElement[this.scrollAttrY]\n        });\n    };\n\n    provisionRef = element => {\n        this.refElement = element;\n    };\n\n    render() {\n        return (\n            <div\n                className={`scrollable ${this.props.className}`}\n                ref={this.provisionRef}\n                onMouseDown={this.provisionOnMouseDown}\n            >\n                {React.Children.map(this.props.children, child =>\n                    React.Children.only(child)\n                )}\n            </div>\n        );\n    }\n}\n\nScrollWindow.defaultProps = {\n    className: ''\n};\n\nScrollWindow.propTypes = {\n    className: PropTypes.string\n};\n","import * as d3 from 'd3';\n\nexport default class AncestryCoverage {\n    constructor(anchor, colourMap, rootChange) {\n        this.anchor = anchor;\n        this.colourMap = colourMap;\n        this.rootChange = rootChange;\n    }\n\n    drawAncestorChart(data) {\n        const root = this.partition(data);\n\n        const width = 200;\n        const radius = width / (2 * root.height + 1);\n\n        this.drawArc = this.defineArcFn(radius);\n\n        root.each(d => (d.current = d));\n        this.svgSunburst = this.createSvg(width);\n        this.ancestorGraphics = this.addAncestorGraphics(width);\n        this.path = this.addPathGraphics(root);\n\n        this.parent = this.addParentGraphic(root, radius);\n\n        const zoomEvent = this.zoomFn(root);\n\n        this.addPathPopup();\n        this.addParentPopup();\n        this.addParentClick(zoomEvent);\n        this.addPathClick(zoomEvent);\n    }\n\n    zoomFn(root) {\n        return (event, p) => {\n            this.parent.datum(p.parent || root);\n\n            root.each(\n                d =>\n                    (d.target = {\n                        x0:\n                            Math.max(\n                                0,\n                                Math.min(1, (d.x0 - p.x0) / (p.x1 - p.x0))\n                            ) *\n                            2 *\n                            Math.PI,\n                        x1:\n                            Math.max(\n                                0,\n                                Math.min(1, (d.x1 - p.x0) / (p.x1 - p.x0))\n                            ) *\n                            2 *\n                            Math.PI,\n                        y0: Math.max(0, d.y0 - p.depth),\n                        y1: Math.max(0, d.y1 - p.depth)\n                    })\n            );\n\n            const transitionAni = this.ancestorGraphics\n                .transition()\n                .duration(750);\n            this.path\n                .transition(transitionAni)\n                .tween('data', d => {\n                    const i = d3.interpolate(d.current, d.target);\n                    return t => (d.current = i(t));\n                })\n                .attrTween('d', d => () => this.drawArc(d.current))\n                .attrTween('fill-opacity', () => () => 0.7);\n\n            this.updateParentPopup(p);\n            this.rootChange(p.data);\n        };\n    }\n\n    addPathClick(clicked) {\n        this.path\n            .filter(d => d.children)\n            .style('cursor', 'pointer')\n            .on('click', clicked);\n    }\n\n    selectName(name) {\n        this.path\n            .transition(this.ancestorGraphics.transition())\n            .attrTween('fill-opacity', d => () =>\n                !name || name === d.data.surname ? 0.7 : 0.2\n            );\n    }\n\n    selectPlace(place) {\n        this.path\n            .transition(this.ancestorGraphics.transition())\n            .attrTween('fill-opacity', d => () =>\n                !place || place === d.data.origin ? 0.7 : 0.2\n            );\n    }\n\n    addParentClick(clicked) {\n        this.parent.style('cursor', 'pointer').on('click', clicked);\n    }\n\n    addParentGraphic(root, radius) {\n        return this.ancestorGraphics\n            .append('circle')\n            .datum(root)\n            .attr('r', radius)\n            .attr('fill', 'none')\n            .attr('pointer-events', 'all');\n    }\n\n    addPathPopup() {\n        this.path.append('title').text(this.renderPopup);\n    }\n\n    addParentPopup() {\n        this.parent.append('title').text(this.renderPopup);\n    }\n\n    renderPopup = d => {\n        let yearOfBirth = d.data.yearOfBirth ? d.data.yearOfBirth : '?';\n        let yearOfDeath = d.data.yearOfDeath ? d.data.yearOfDeath : '?';\n        return `${d.data.name}\\n(${yearOfBirth} - ${yearOfDeath})`;\n    };\n\n    updateParentPopup(d) {\n        this.parent.select('title').text(() => {\n            return this.renderPopup(d);\n        });\n    }\n\n    addPathGraphics(root) {\n        return this.ancestorGraphics\n            .append('g')\n            .selectAll('path')\n            .data(root)\n            .join('path')\n            .attr('fill', d => {\n                return this.colourMap(d.data.surname);\n            })\n            .attr('fill-opacity', () => 0.7)\n            .attr('d', d => this.drawArc(d.current));\n    }\n\n    addAncestorGraphics(width) {\n        return this.svgSunburst\n            .append('g')\n            .attr('transform', `translate(${width / 2},${width / 2})`);\n    }\n\n    createSvg(width) {\n        return d3\n            .select(this.anchor)\n            .append('svg')\n            .attr('viewBox', [0, 0, width, width])\n            .style('font', '10px sans-serif');\n    }\n\n    bisect(maxHeight) {\n        return node => {\n            node.value = Math.pow(2, maxHeight - node.depth);\n        };\n    }\n\n    padSingleMother = node => {\n        if (\n            node.parent &&\n            node.parent.children.length === 1 &&\n            node.data.mother\n        ) {\n            const size = node.x1 - node.x0;\n            this.shiftNodes(size)(node);\n        }\n    };\n\n    shiftNodes(arc) {\n        return node => {\n            node.x0 = node.x0 + arc;\n            node.x1 = node.x1 + arc;\n            if (node.children) {\n                node.children.forEach(this.shiftNodes(arc));\n            }\n        };\n    }\n\n    partition(data) {\n        const root = d3.hierarchy(data);\n        root.each(this.bisect(root.height));\n\n        const partition = d3.partition().size([2 * Math.PI, root.height + 1])(\n            root\n        );\n\n        root.each(this.padSingleMother);\n        return partition;\n    }\n\n    defineArcFn(radius) {\n        return d3\n            .arc()\n            .startAngle(d => d.x0)\n            .endAngle(d => d.x1)\n            .padRadius(radius * 1.5)\n            .innerRadius(d => d.y0 * radius)\n            .outerRadius(d => Math.max(d.y0 * radius, d.y1 * radius - 1));\n    }\n}\n","export default class NameConsolidation {\n    static consolidate(nameFreq) {\n        return Object.entries(nameFreq).reduce((acc, curr) => {\n            const name = curr[0];\n            const quantity = curr[1];\n            const variant = NameConsolidation.nameVariant(acc, name);\n            const consolidatedName = variant ? variant : name;\n\n            acc[consolidatedName]\n                ? (acc[consolidatedName] += quantity)\n                : (acc[consolidatedName] = quantity);\n            return acc;\n        }, {});\n    }\n\n    static nameVariant(processed, name) {\n        const matches = Object.entries(processed).reduce((acc, curr) => {\n            const processedName = curr[0];\n            if (\n                NameConsolidation.levenshteinDistance(processedName, name) <= 1\n            ) {\n                acc.push(processedName);\n            }\n            return acc;\n        }, []);\n        if (matches.length > 0) {\n            return matches[0];\n        } else {\n            return null;\n        }\n    }\n\n    static levenshteinDistance(name1, name2) {\n        const len1 = name1.length;\n        const len2 = name2.length;\n\n        let matrix = Array(len1 + 1);\n        for (let i = 0; i <= len1; i++) {\n            matrix[i] = Array(len2 + 1);\n        }\n\n        for (let i = 0; i <= len1; i++) {\n            matrix[i][0] = i;\n        }\n\n        for (let j = 0; j <= len2; j++) {\n            matrix[0][j] = j;\n        }\n\n        for (let i = 1; i <= len1; i++) {\n            for (let j = 1; j <= len2; j++) {\n                if (name1[i - 1] === name2[j - 1]) {\n                    matrix[i][j] = matrix[i - 1][j - 1];\n                } else {\n                    matrix[i][j] = Math.min(\n                        matrix[i - 1][j] + 1,\n                        matrix[i][j - 1] + 1,\n                        matrix[i - 1][j - 1] + 1\n                    );\n                }\n            }\n        }\n\n        return matrix[len1][len2];\n    }\n}\n","import datasource from '../../datasource/Datasource';\nimport PropTypes from 'prop-types';\nimport NameConsolidation from './NameConsolidation';\n\nexport const PersonTreeType = PropTypes.shape({\n    name: PropTypes.string,\n    surname: PropTypes.string,\n    yearOfBirth: PropTypes.number,\n    yearOfDeath: PropTypes.number,\n    id: PropTypes.number,\n    children: PropTypes.array,\n    mother: PropTypes.boolean\n});\n\nexport default class DataAnalysis {\n    static getData(state, id, mother) {\n        const person = datasource.findPerson(state, id);\n        let surname = person.name.split(' ')[person.name.split(' ').length - 1];\n        surname = surname === '?' || surname === '' ? '<Unknown>' : surname;\n        const personTreeData = {\n            name: person.name,\n            surname: surname,\n            yearOfBirth: person.yearOfBirth,\n            yearOfDeath: person.yearOfDeath,\n            id: person.id,\n            mother: mother,\n            origin: person.origin\n        };\n\n        const parentData = DataAnalysis.getParentData(state, person);\n\n        if (parentData.length > 0) {\n            personTreeData.children = parentData;\n        }\n        return personTreeData;\n    }\n\n    static getParentData(state, person) {\n        const parentData = [];\n        if (person.father) {\n            const father = DataAnalysis.getData(state, person.father);\n            parentData.push(father);\n        }\n        if (person.mother) {\n            const mother = DataAnalysis.getData(state, person.mother, true);\n            parentData.push(mother);\n        }\n        return parentData;\n    }\n\n    static extractNameData(data) {\n        const names = [];\n        DataAnalysis.populateNames(data, names);\n\n        const nameFrequency = DataAnalysis.calcFrequency(names);\n        const consolidatedNameFreq = NameConsolidation.consolidate(\n            nameFrequency\n        );\n        return DataAnalysis.sortDataTable(\n            DataAnalysis.createDataTable(consolidatedNameFreq)\n        );\n    }\n\n    static createDataTable(nameFrequency) {\n        return Object.entries(nameFrequency).reduce((acc, curr) => {\n            acc.push({ name: curr[0], quantity: curr[1] });\n            return acc;\n        }, []);\n    }\n\n    static sortDataTable(namesData) {\n        namesData.sort((a, b) => {\n            return b.quantity - a.quantity;\n        });\n        return namesData;\n    }\n\n    static calcFrequency(names) {\n        return names.reduce((acc, name) => {\n            acc[name] ? acc[name]++ : (acc[name] = 1);\n            return acc;\n        }, {});\n    }\n\n    static populateNames(person, names) {\n        names.push(person.surname);\n        if (person.children) {\n            person.children.forEach(child =>\n                DataAnalysis.populateNames(child, names)\n            );\n        }\n    }\n\n    static extractOriginData(data) {\n        const origins = [];\n        DataAnalysis.populateOrigins(data, origins);\n\n        const originFrequency = DataAnalysis.calcFrequency(origins);\n        return DataAnalysis.createDataTable(originFrequency);\n    }\n\n    static populateOrigins(person, origins) {\n        if (person.origin) {\n            origins.push(person.origin);\n        }\n        if (person.children) {\n            person.children.forEach(child =>\n                DataAnalysis.populateOrigins(child, origins)\n            );\n        }\n    }\n}\n","import * as d3 from 'd3';\nimport DataAnalysis from './DataAnalysis';\n\nexport default class NameFrequency {\n    constructor(anchor, colourMap, selectCallback) {\n        this.anchor = anchor;\n        this.colourMap = colourMap;\n        this.selectCallback = selectCallback;\n        this.margin = { top: 20, right: 30, bottom: 40, left: 90 };\n        this.width = 500 - this.margin.left - this.margin.right;\n    }\n\n    drawNameChart(data) {\n        this.data = data;\n        this.nameData = DataAnalysis.extractNameData(data);\n        this.namesHeight = 15 * this.nameData.length;\n\n        this.addNamesGraphics();\n        this.calcXScale();\n        this.calcYScale();\n\n        this.addAxisGraphics();\n        this.drawEntryBars();\n    }\n\n    calcXScale() {\n        this.xScale = d3\n            .scaleLinear()\n            .domain([0, this.nameData[0].quantity])\n            .range([0, this.width]);\n    }\n\n    calcYScale() {\n        this.yScale = d3\n            .scaleBand()\n            .range([0, this.namesHeight])\n            .domain(\n                this.nameData.map(function(d) {\n                    return d.name;\n                })\n            )\n            .padding(0.1);\n    }\n\n    drawEntryBars() {\n        this.drawBars(\n            this.svg\n                .selectAll('rect')\n                .data(this.nameData)\n                .enter()\n                .append('rect')\n                .on('click', (event, d) => {\n                    this.selectName(d.name);\n                })\n                .style('cursor', 'pointer')\n        )\n            .append('svg:title')\n            .text(this.popup);\n    }\n\n    selectName(name) {\n        this.surname = this.surname && this.surname === name ? undefined : name;\n        this.selectCallback(this.surname);\n        this.redrawChart(this.data);\n    }\n\n    popup(d) {\n        return `${d.name} (${d.quantity})`;\n    }\n\n    redrawNameChart(data) {\n        this.surname = undefined;\n        this.redrawChart(data);\n    }\n\n    redrawChart(data) {\n        this.data = data ? data : this.data;\n        const newData = DataAnalysis.extractNameData(this.data);\n        this.hideAdditionalBars(newData.length);\n\n        this.nameData = newData;\n        this.namesHeight = 15 * this.nameData.length;\n\n        this.calcXScale();\n        this.calcYScale();\n\n        this.drawBars(\n            this.svg\n                .selectAll('rect')\n                .data(this.nameData)\n                .merge(this.svg)\n                .transition()\n                .duration(750)\n        )\n            .select('title')\n            .text(this.popup);\n\n        this.addAxisGraphics();\n    }\n\n    hideAdditionalBars(newDataSize) {\n        this.drawBars(\n            this.svg\n                .selectAll('rect')\n                .data(this.nameData)\n                .merge(this.svg),\n            (d, i) => {\n                if (i < newDataSize) {\n                    return this.xScale(d.quantity);\n                }\n                return this.xScale(0);\n            }\n        );\n        this.xAxis.remove();\n        this.yAxis.remove();\n    }\n\n    drawBars(svgBase, xScaleOverride) {\n        const x =\n            xScaleOverride ||\n            (d => {\n                return this.xScale(d.quantity);\n            });\n        const y = this.yScale;\n\n        return svgBase\n            .attr('x', x(0))\n            .attr('y', function(d) {\n                return y(d.name);\n            })\n            .attr('width', function(d, i) {\n                return x(d, i);\n            })\n            .attr('height', y.bandwidth())\n            .attr('fill', d => {\n                return this.colourMap(d.name);\n            })\n            .attr('fill-opacity', d =>\n                !this.surname || this.surname === d.name ? 0.7 : 0.2\n            );\n    }\n\n    addAxisGraphics() {\n        this.xAxis = this.svg\n            .append('g')\n            .attr('transform', `translate(0,${this.namesHeight})`);\n        const tickNumber = Math.min(this.nameData[0].quantity, 5);\n        this.xAxis\n            .call(\n                d3\n                    .axisBottom(this.xScale)\n                    .ticks(tickNumber)\n                    .tickFormat(d3.format(',d'))\n            )\n            .selectAll('text')\n            .attr('transform', 'translate(-10,0)rotate(-45)')\n            .style('text-anchor', 'end');\n        this.yAxis = this.svg.append('g').call(d3.axisLeft(this.yScale));\n    }\n\n    addNamesGraphics() {\n        this.svg = d3\n            .select(this.anchor)\n            .append('svg')\n            .attr('width', this.width + this.margin.left + this.margin.right)\n            .attr(\n                'height',\n                this.namesHeight + this.margin.top + this.margin.bottom\n            )\n            .append('g')\n            .attr(\n                'transform',\n                `translate(${this.margin.left},${this.margin.top})`\n            );\n    }\n}\n","import * as d3 from 'd3';\nimport * as topojson from 'topojson';\nimport uk from './uk.json';\nimport DataAnalysis from './DataAnalysis';\n\nexport default class OriginMap {\n    constructor(anchor, places, selectCallback) {\n        this.anchor = anchor;\n        this.places = places;\n        this.selectCallback = selectCallback;\n        this.width = 910;\n        this.height = 1020;\n    }\n\n    drawOriginChart(data) {\n        this.projection = this.mapProjection();\n        this.svg = this.addMapGraphics();\n        this.path = d3.geoPath().projection(this.projection);\n\n        this.drawRegions();\n        this.drawBoundaries();\n\n        this.drawPlaceNames();\n\n        this.originData = DataAnalysis.extractOriginData(data)\n            .filter(d => this.places[d.name])\n            .sort((a, b) => d3.descending(a.quantity, b.quantity));\n\n        this.drawOrigins();\n    }\n\n    redrawOriginChart(data) {\n        this.place = undefined;\n        if (data) {\n            const newOriginData = DataAnalysis.extractOriginData(data);\n            for (const index in this.originData) {\n                const newOriginDataItem = newOriginData.filter(\n                    d => d.name === this.originData[index].name\n                );\n                this.originData[index].quantity =\n                    newOriginDataItem.length > 0\n                        ? newOriginDataItem[0].quantity\n                        : 0;\n            }\n        }\n        this.redrawChart();\n    }\n\n    redrawChart() {\n        const radius = d3.scaleSqrt(\n            [0, d3.max(this.originData, d => d.quantity)],\n            [0, 40]\n        );\n        this.svg\n            .selectAll('circle')\n            .data(this.originData)\n            .merge(this.svg)\n            .transition()\n            .duration(750)\n            .attr('r', d => radius(d.quantity))\n            .attr('fill-opacity', d =>\n                !this.place || this.place === d.name ? 0.5 : 0.1\n            )\n            .select('title')\n            .text(d => `${d.name} (${d.quantity})`);\n    }\n\n    drawOrigins(svg) {\n        this.svg\n            .append('g')\n            .attr('fill', 'red')\n            .attr('stroke', '#fff')\n            .attr('stroke-width', 0.5)\n            .selectAll('circle')\n            .data(this.originData)\n            .join('circle')\n            .on('click', (event, d) => {\n                this.selectPlace(d.name);\n            })\n            .attr(\n                'transform',\n                d =>\n                    `translate(${this.projection([\n                        this.places[d.name].long,\n                        this.places[d.name].lat\n                    ])})`\n            )\n            .append('title');\n        this.redrawChart();\n    }\n\n    mapProjection() {\n        return d3\n            .geoAlbers()\n            .center([0, 55.4])\n            .rotate([4.4, 0])\n            .parallels([50, 60])\n            .scale(1200 * 5)\n            .translate([this.width / 2 - 20, this.height / 2 - 80]);\n    }\n\n    addMapGraphics() {\n        return d3\n            .select(this.anchor)\n            .append('svg')\n            .attr('width', this.width)\n            .attr('height', this.height);\n    }\n\n    drawRegions() {\n        const regionData = topojson.feature(uk, uk.objects.subunits);\n\n        const regionColour = {\n            SCT: '#abf',\n            WLS: '#eaa',\n            NIR: '#aea',\n            ENG: '#eee',\n            IRL: '#ada'\n        };\n\n        this.svg\n            .selectAll('.subunit')\n            .data(regionData.features)\n            .enter()\n            .append('path')\n            .attr('class', d => {\n                return 'subunit ' + d.id;\n            })\n            .attr('fill', d => {\n                return regionColour[d.id];\n            })\n            .attr('d', this.path);\n\n        this.drawRegionNames(regionData);\n    }\n\n    drawRegionNames(regionData) {\n        this.svg\n            .selectAll('.subunit-label')\n            .data(regionData.features)\n            .enter()\n            .append('text')\n            .attr('transform', d => {\n                return 'translate(' + this.path.centroid(d) + ')';\n            })\n            .attr('fill', '#888')\n            .attr('fill-opacity', '.5')\n            .attr('font-size', '20px')\n            .attr('font-weight', '300')\n            .attr('text-anchor', 'middle')\n            .text(d => {\n                return d.properties.name;\n            });\n    }\n\n    drawPlaceNames() {\n        const places = topojson.feature(uk, uk.objects.places);\n        const plotted = {};\n\n        this.svg\n            .append('path')\n            .datum(places)\n            .attr('d', this.path)\n            .style('fill', '#777');\n\n        this.svg\n            .selectAll('.label')\n            .data(\n                places.features.sort((a, b) =>\n                    d3.descending(\n                        a.geometry.coordinates[0],\n                        b.geometry.coordinates[0]\n                    )\n                )\n            )\n            .enter()\n            .append('text')\n            .attr('clashDetection', d => {\n                d.clash = this.detectLabelClash(plotted, d);\n                plotted[d.properties.name] = d.geometry.coordinates;\n                return d.clash;\n            })\n            .attr('transform', d => {\n                return (\n                    'translate(' + this.projection(d.geometry.coordinates) + ')'\n                );\n            })\n            .attr('x', d => {\n                return d.clash ? -6 : 6;\n            })\n            .attr('dy', '.35em')\n            .style('text-anchor', d => {\n                return d.clash ? 'end' : 'start';\n            })\n            .style('font-size', '.75rem')\n            .style('fill', '#999')\n            .text(d => {\n                return d.properties.name;\n            });\n    }\n\n    detectLabelClash(plotted, d) {\n        for (const plot in plotted) {\n            if (\n                Math.abs(d.geometry.coordinates[0] - plotted[plot][0]) < 1 &&\n                d.geometry.coordinates[0] - plotted[plot][0] < 0 &&\n                Math.abs(d.geometry.coordinates[1] - plotted[plot][1]) < 0.1\n            ) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    drawBoundaries() {\n        this.svg\n            .append('path')\n            .datum(\n                topojson.mesh(uk, uk.objects.subunits, (a, b) => {\n                    return a !== b;\n                })\n            )\n            .attr('d', this.path)\n            .attr('fill', 'none')\n            .attr('stroke', '#777')\n            .attr('stroke-dasharray', '2,2')\n            .attr('stroke-linejoin', 'round');\n    }\n\n    selectPlace(name) {\n        this.place = this.place && this.place === name ? undefined : name;\n        this.selectCallback(this.place);\n        this.redrawChart();\n    }\n}\n","import React from 'react';\nimport * as d3 from 'd3';\nimport { connect } from 'react-redux';\nimport { Col, Container, Row } from 'reactstrap';\nimport ScrollWindow from './ScrollWindow';\nimport AncestryCoverage from './charts/AncestryCoverage';\nimport NameFrequency from './charts/NameFrequency';\nimport OriginMap from './charts/OriginMap';\nimport DataAnalysis, { PersonTreeType } from './charts/DataAnalysis';\n\nexport class AnalysisView extends React.Component {\n    componentDidMount() {\n        this.colourMap = this.colourMap();\n        this.nameFrequency = new NameFrequency(\n            this.nameFrequencyChart,\n            this.colourMap,\n            name => {\n                this.ancestryCoverage.selectName(name);\n                this.originMap.redrawOriginChart();\n            }\n        );\n\n        this.originMap = new OriginMap(\n            this.originMapChart,\n            this.props.places,\n            place => {\n                this.ancestryCoverage.selectPlace(place);\n                this.nameFrequency.redrawNameChart();\n            }\n        );\n\n        this.ancestryCoverage = new AncestryCoverage(\n            this.ancestryCoverageChart,\n            this.colourMap,\n            data => {\n                this.nameFrequency.redrawNameChart(data);\n                this.originMap.redrawOriginChart(data);\n            }\n        );\n\n        this.ancestryCoverage.drawAncestorChart(this.props.data);\n        this.nameFrequency.drawNameChart(this.props.data);\n        this.originMap.drawOriginChart(this.props.data);\n    }\n\n    colourMap() {\n        return d3.scaleOrdinal(d3.quantize(d3.interpolateRainbow, 2 ^ 30));\n    }\n\n    render() {\n        const ancestryCoverageChart = el => (this.ancestryCoverageChart = el);\n        const nameFrequencyChart = el => (this.nameFrequencyChart = el);\n        const originMapChart = el => (this.originMapChart = el);\n        return (\n            <span>\n                <ScrollWindow>\n                    <Container fluid={true}>\n                        <Row>\n                            <Col sm={6} className=\"text-center\">\n                                <Row>\n                                    <Col sm={12} className=\"text-center\">\n                                        <h1>Ancestry Coverage</h1>\n                                    </Col>\n                                    <Col sm={12} className=\"text-center\">\n                                        <div\n                                            ref={ancestryCoverageChart}\n                                            className=\"ancestryCoverageChart\"\n                                        />\n                                    </Col>\n                                    <Col sm={12} className=\"text-center\">\n                                        <h1>Name Frequency</h1>\n                                    </Col>\n                                    <Col sm={12} className=\"text-center\">\n                                        <div\n                                            ref={nameFrequencyChart}\n                                            className=\"nameFrequencyChart\"\n                                        />\n                                    </Col>\n                                </Row>\n                            </Col>\n                            <Col sm={6} className=\"text-center\">\n                                <Row>\n                                    <Col sm={12} className=\"text-center\">\n                                        <h1>Origin Map</h1>\n                                    </Col>\n                                    <Col sm={12} className=\"text-center\">\n                                        <div\n                                            ref={originMapChart}\n                                            className=\"originMapChart\"\n                                        />\n                                    </Col>\n                                </Row>\n                            </Col>\n                        </Row>\n                    </Container>\n                </ScrollWindow>\n            </span>\n        );\n    }\n}\n\nAnalysisView.propTypes = {\n    data: PersonTreeType\n};\n\nconst mapStateToProps = state => ({\n    data: DataAnalysis.getData(state, state.tree.rootId),\n    places: state.dataRepository.places\n});\n\nexport default connect(mapStateToProps)(AnalysisView);\n","import React from 'react';\nimport { personType } from '../datasource/DataTypes';\nimport PropTypes from 'prop-types';\n\nexport default class Person extends React.Component {\n    renderLifespan = person => {\n        let yearOfBirth = person.yearOfBirth ? person.yearOfBirth : '?';\n        let yearOfDeath = person.yearOfDeath ? person.yearOfDeath : '?';\n        return `(${yearOfBirth} - ${yearOfDeath})`;\n    };\n\n    render() {\n        let person = this.props.person;\n\n        let name = '?';\n        let lifespan = '';\n\n        if (person) {\n            name = person.name;\n            lifespan = this.renderLifespan(person);\n        }\n\n        return (\n            <div id={this.props.divId}>\n                <br />\n                <div className=\"personName\">{name}</div>\n                <div className=\"personLifespan\">{lifespan}</div>\n                <br />\n            </div>\n        );\n    }\n}\n\nPerson.propTypes = {\n    person: personType,\n    divId: PropTypes.string\n};\n","import React from 'react';\nimport {\n    Col,\n    Container,\n    Row,\n    UncontrolledPopover,\n    PopoverBody\n} from 'reactstrap';\nimport Person from './Person';\nimport datasource from '../datasource/Datasource';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\n\nexport class Siblings extends React.Component {\n    renderPerson = person => {\n        return <Person person={person} />;\n    };\n\n    renderHalfByFather = siblings => {\n        return siblings.halfByFather.map((group, index) => (\n            <Row className=\"halfByFather\" key={index}>\n                <Col xs={6} className=\"childrenByFather\">\n                    <Container fluid={true}>\n                        {this.renderChildren(group)}\n                    </Container>\n                </Col>\n                <Col xs={6} className=\"stepMother\">\n                    <Container fluid={true}>\n                        {this.renderChildren([\n                            siblings.parents[`parent_${group[0].mother}`]\n                        ])}\n                    </Container>\n                </Col>\n            </Row>\n        ));\n    };\n\n    renderHalfByMother = siblings => {\n        return siblings.halfByMother.map((group, index) => (\n            <Row className=\"halfByMother\" key={index}>\n                <Col xs={6} className=\"childrenByMother\">\n                    <Container fluid={true}>\n                        {this.renderChildren(group)}\n                    </Container>\n                </Col>\n                <Col xs={6} className=\"stepFather\">\n                    <Container fluid={true}>\n                        {this.renderChildren([\n                            siblings.parents[`parent_${group[0].father}`]\n                        ])}\n                    </Container>\n                </Col>\n            </Row>\n        ));\n    };\n\n    renderFullSiblings = siblings => {\n        let group = siblings.fullSiblings;\n        let father = siblings.parents[`parent_${group[0].father}`];\n        let mother = siblings.parents[`parent_${group[0].mother}`];\n\n        return (\n            <Row className=\"fullSiblings\">\n                <Col xs={6} className=\"siblingChildren\">\n                    <Container fluid={true}>\n                        {this.renderChildren(group)}\n                    </Container>\n                </Col>\n                <Col xs={6} className=\"siblingParents\">\n                    <Container fluid={true}>\n                        {this.renderChildren([father, mother])}\n                    </Container>\n                </Col>\n            </Row>\n        );\n    };\n\n    renderChildren = group => {\n        return group.map((person, index) => (\n            <Row key={index}>\n                <Col\n                    xs={12}\n                    className={\n                        person && person.id === this.props.personId\n                            ? 'siblingPerson font-weight-bold'\n                            : 'siblingPerson'\n                    }\n                >\n                    {this.renderPerson(person)}\n                </Col>\n            </Row>\n        ));\n    };\n\n    render() {\n        let siblings = this.props.siblings;\n        let enablePopover = Object.keys(siblings.parents).length > 0;\n        return (\n            <div className=\"siblings\">\n                {enablePopover && (\n                    <UncontrolledPopover\n                        placement=\"left\"\n                        trigger=\"hover\"\n                        delay={1000}\n                        target={`personCol${this.props.personId}`}\n                        className=\"siblingPopper\"\n                    >\n                        <PopoverBody>\n                            <Container fluid={true}>\n                                {this.renderHalfByFather(siblings)}\n                                {this.renderFullSiblings(siblings)}\n                                {this.renderHalfByMother(siblings)}\n                            </Container>\n                        </PopoverBody>\n                    </UncontrolledPopover>\n                )}\n            </div>\n        );\n    }\n}\n\nSiblings.propTypes = {\n    personId: PropTypes.number.isRequired\n};\n\nconst mapStateToProps = (state, ownProps) => ({\n    siblings: datasource.findSiblings(state, ownProps.personId)\n});\n\nexport default connect(mapStateToProps, {})(Siblings);\n","import React from 'react';\nimport { Col, Container, Row } from 'reactstrap';\nimport Person from './Person';\nimport Siblings from './Siblings';\nimport datasource from '../datasource/Datasource';\nimport { personType } from '../datasource/DataTypes';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { showPerson } from '../state/actions/DetailsActions';\nimport SubTreeNode from './TreeNode';\n\nexport class TreeNode extends React.Component {\n    selectPerson = () => {\n        this.props.showPerson(this.props.id);\n    };\n\n    render() {\n        return (\n            <div>\n                <Container className=\"node\">\n                    <Row className=\"nodePerson\">\n                        <Col\n                            sm={6}\n                            className=\"vcenter showOption\"\n                            onClick={this.selectPerson}\n                        >\n                            <Person\n                                person={this.props.person}\n                                divId={`personCol${this.props.id}`}\n                            />\n                        </Col>\n                        {this.props.person && (\n                            <Siblings personId={this.props.id} />\n                        )}\n                        <Col sm={6}>\n                            {this.props.person && (\n                                <Container className=\"node nodeParents\">\n                                    <Row className=\"father\">\n                                        <Col sm={12} className=\"nodeFather\">\n                                            <SubTreeNode\n                                                id={this.props.person.father}\n                                            />\n                                        </Col>\n                                    </Row>\n                                    <Row className=\"mother\">\n                                        <Col sm={12} className=\"nodeMother\">\n                                            <SubTreeNode\n                                                id={this.props.person.mother}\n                                            />\n                                        </Col>\n                                    </Row>\n                                </Container>\n                            )}\n                        </Col>\n                    </Row>\n                </Container>\n            </div>\n        );\n    }\n}\n\nTreeNode.propTypes = {\n    showPerson: PropTypes.func,\n    id: PropTypes.number,\n    person: personType\n};\n\nconst mapStateToProps = (state, ownProps) => ({\n    person: datasource.findPerson(state, ownProps.id)\n});\n\nexport default connect(mapStateToProps, { showPerson })(TreeNode);\n","import React from 'react';\nimport {\n    Carousel,\n    CarouselItem,\n    CarouselControl,\n    CarouselIndicators,\n    CarouselCaption,\n    Modal,\n    ModalBody\n} from 'reactstrap';\nimport ScrollWindow from './ScrollWindow';\nimport PropTypes from 'prop-types';\nimport {\n    selectGalleryNext,\n    selectGalleryPrev,\n    selectGalleryScalePlus,\n    selectGalleryScaleMinus,\n    selectGalleryIndex,\n    toggleGallery\n} from '../state/actions/DetailsActions';\nimport { connect } from 'react-redux';\n\nexport class Gallery extends React.Component {\n    carouselItems = () => {\n        return this.props.galleryItems.map((item, index) => (\n            <CarouselItem key={index}>\n                <ScrollWindow className=\"galleryItem\">\n                    <div className={`galleryImageX${this.props.galleryScale}`}>\n                        <img\n                            src={item.src}\n                            alt={item.caption}\n                            className=\"galleryImageX1\"\n                            draggable={false}\n                        />\n                    </div>\n                </ScrollWindow>\n                <CarouselCaption captionText={item.caption} />\n            </CarouselItem>\n        ));\n    };\n\n    renderButtons = () => {\n        return (\n            <div>\n                <button\n                    className=\"fab closeGallery\"\n                    onClick={this.props.toggleGallery}\n                >\n                    &times;\n                </button>\n                <button\n                    className=\"fab plusGallery\"\n                    onClick={this.props.selectGalleryScalePlus}\n                >\n                    &#43;\n                </button>\n                <button\n                    className=\"fab minusGallery\"\n                    onClick={this.props.selectGalleryScaleMinus}\n                >\n                    &minus;\n                </button>\n            </div>\n        );\n    };\n\n    render() {\n        return (\n            <Modal\n                isOpen={this.props.galleryItems.length > 0}\n                external={this.renderButtons()}\n                className=\"galleryModal\"\n                contentClassName=\"galleryContent\"\n            >\n                <ModalBody>\n                    <Carousel\n                        activeIndex={this.props.galleryIndex}\n                        next={this.props.selectGalleryNext}\n                        previous={this.props.selectGalleryPrev}\n                        interval={false}\n                    >\n                        <CarouselIndicators\n                            items={this.props.galleryItems}\n                            activeIndex={this.props.galleryIndex}\n                            onClickHandler={this.props.selectGalleryIndex}\n                        />\n                        {this.carouselItems()}\n                        <CarouselControl\n                            direction=\"prev\"\n                            directionText=\"Previous\"\n                            onClickHandler={this.props.selectGalleryPrev}\n                        />\n                        <CarouselControl\n                            direction=\"next\"\n                            directionText=\"Next\"\n                            onClickHandler={this.props.selectGalleryNext}\n                        />\n                    </Carousel>\n                </ModalBody>\n            </Modal>\n        );\n    }\n}\n\nGallery.propTypes = {\n    galleryItems: PropTypes.arrayOf(\n        PropTypes.shape({\n            src: PropTypes.string,\n            caption: PropTypes.string\n        })\n    ).isRequired,\n    galleryIndex: PropTypes.number.isRequired,\n    galleryScale: PropTypes.number.isRequired,\n    toggleGallery: PropTypes.func.isRequired,\n    selectGalleryNext: PropTypes.func.isRequired,\n    selectGalleryPrev: PropTypes.func.isRequired,\n    selectGalleryScalePlus: PropTypes.func.isRequired,\n    selectGalleryScaleMinus: PropTypes.func.isRequired,\n    selectGalleryIndex: PropTypes.func.isRequired\n};\n\nconst mapStateToProps = state => ({\n    galleryItems: state.details.galleryItems,\n    galleryIndex: state.details.galleryIndex,\n    galleryScale: state.details.galleryScale\n});\n\nexport default connect(mapStateToProps, {\n    selectGalleryNext,\n    selectGalleryPrev,\n    selectGalleryScalePlus,\n    selectGalleryScaleMinus,\n    selectGalleryIndex,\n    toggleGallery\n})(Gallery);\n","import React from 'react';\nimport { Col, Container, Row, UncontrolledTooltip } from 'reactstrap';\nimport Person from './Person';\nimport Gallery from './Gallery';\nimport {\n    showPerson,\n    selectResourcePreview,\n    toggleGallery\n} from '../state/actions/DetailsActions';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { personType, factType } from '../datasource/DataTypes';\n\nexport class Details extends React.Component {\n    renderFacts = () => {\n        if (this.props.facts) {\n            return this.props.facts.map((fact, factIndex) => (\n                <Row\n                    className=\"fact\"\n                    onClick={() => this.props.selectResourcePreview(factIndex)}\n                    key={factIndex}\n                >\n                    <Col xs={1} className=\"factYear\">\n                        {fact.year}\n                    </Col>\n                    <Col xs={11} className=\"factDetail\">\n                        {fact.fact}\n                    </Col>\n                </Row>\n            ));\n        }\n    };\n\n    renderPreview = () => {\n        return (\n            <Row>\n                <Col xs={12}>\n                    <img\n                        src={this.props.currentResource}\n                        alt={this.props.currentFact}\n                        className=\"previewBox\"\n                        id=\"previewBox\"\n                        onClick={this.props.toggleGallery}\n                    />\n                    <UncontrolledTooltip placement=\"auto\" target=\"previewBox\">\n                        {this.props.currentFact}\n                    </UncontrolledTooltip>\n                    {this.props.showGallery && <Gallery />}\n                </Col>\n            </Row>\n        );\n    };\n\n    render() {\n        return (\n            <div className=\"detailsHolder\">\n                {this.props.person && (\n                    <div className=\"details\">\n                        <div>\n                            <button\n                                className=\"fab closeDetails\"\n                                onClick={() => this.props.showPerson()}\n                            >\n                                &times;\n                            </button>\n                        </div>\n                        <Container fluid={true}>\n                            <Row id=\"personId\">\n                                <Col xs={12} className=\"h3 text-center\">\n                                    <Person person={this.props.person} />\n                                </Col>\n                            </Row>\n                            <UncontrolledTooltip\n                                placement=\"auto\"\n                                target=\"personId\"\n                            >\n                                {this.props.personId}\n                            </UncontrolledTooltip>\n                            {this.props.currentResource && this.renderPreview()}\n                        </Container>\n                        <Container fluid={true} className=\"detailsFacts\">\n                            {this.renderFacts()}\n                        </Container>\n                    </div>\n                )}\n            </div>\n        );\n    }\n}\n\nDetails.propTypes = {\n    personId: PropTypes.number,\n    person: personType,\n    facts: PropTypes.arrayOf(factType),\n    currentResource: PropTypes.string,\n    currentFact: PropTypes.string,\n    showGallery: PropTypes.bool,\n    galleryItems: PropTypes.arrayOf(\n        PropTypes.shape({\n            src: PropTypes.string,\n            caption: PropTypes.string\n        })\n    ),\n    showPerson: PropTypes.func.isRequired,\n    selectResourcePreview: PropTypes.func.isRequired,\n    toggleGallery: PropTypes.func.isRequired\n};\n\nconst mapStateToProps = state => ({\n    personId: state.details.personId,\n    person: state.details.person,\n    facts: state.details.facts,\n    currentResource: state.details.currentResource,\n    currentFact: state.details.currentFact,\n    showGallery: state.details.showGallery,\n    galleryItems: state.details.galleryItems\n});\n\nexport default connect(mapStateToProps, {\n    showPerson,\n    selectResourcePreview,\n    toggleGallery\n})(Details);\n","import React from 'react';\nimport TreeNode from './TreeNode';\nimport ScrollWindow from './ScrollWindow';\nimport Details from './Details';\nimport { Col, Container, Row } from 'reactstrap';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\n\nexport class TreeView extends React.Component {\n    render() {\n        return (\n            <span>\n                <ScrollWindow>\n                    <div>\n                        <Container>\n                            <Row>\n                                <Col sm={12}>\n                                    <TreeNode id={this.props.rootId} />\n                                </Col>\n                            </Row>\n                        </Container>\n                    </div>\n                </ScrollWindow>\n                <Details />\n            </span>\n        );\n    }\n}\n\nTreeView.propTypes = {\n    rootId: PropTypes.number.isRequired\n};\n\nconst mapStateToProps = state => ({\n    rootId: state.tree.rootId\n});\n\nexport default connect(mapStateToProps)(TreeView);\n","import React from 'react';\nimport Heading from './Heading';\nimport { connect } from 'react-redux';\nimport { loadData } from '../state/actions/DataRepositoryActions';\nimport PropTypes from 'prop-types';\nimport AnalysisView from './AnalysisView';\nimport TreeView from './TreeView';\n\nexport class FamilyTree extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            headerHeight: 0\n        };\n        this.headerElement = React.createRef();\n        this.resizeHandler = this.resizeHandler.bind(this);\n    }\n\n    resizeHandler() {\n        const headerHeight = this.headerElement.clientHeight;\n        if (this.state.headerHeight !== headerHeight) {\n            this.setState({ headerHeight });\n        }\n    }\n\n    componentDidUpdate() {\n        this.resizeHandler();\n    }\n\n    componentDidMount() {\n        this.resizeHandler();\n        window.addEventListener('resize', this.resizeHandler);\n        this.props.loadData();\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener('resize', this.resizeHandler);\n    }\n\n    render() {\n        return (\n            <div>\n                <div\n                    className=\"headerWrapper\"\n                    ref={ref => (this.headerElement = ref)}\n                >\n                    <Heading />\n                </div>\n                <div\n                    className=\"viewPort\"\n                    style={{ top: this.state.headerHeight }}\n                >\n                    {this.props.dataLoaded && (\n                        <span>\n                            {this.props.view === 'ANALYSIS' && <AnalysisView />}\n                            {this.props.view === 'TREE' && <TreeView />}\n                        </span>\n                    )}\n                </div>\n                <div className=\"footer\">\n                    <strong>\n                        <a\n                            href=\"https://cmatts.co.uk\"\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            &copy; {new Date().getFullYear()} Calvin Matthews\n                        </a>\n                    </strong>\n                </div>\n            </div>\n        );\n    }\n}\n\nFamilyTree.propTypes = {\n    dataLoaded: PropTypes.bool.isRequired,\n    loadData: PropTypes.func.isRequired,\n    view: PropTypes.string.isRequired\n};\n\nconst mapStateToProps = state => ({\n    dataLoaded: state.dataRepository.dataLoaded,\n    rootId: state.tree.rootId,\n    view: state.tree.view\n});\n\nexport default connect(mapStateToProps, { loadData })(FamilyTree);\n","import React from 'react';\nimport { Col, Container, Row } from 'reactstrap';\n\nexport default class ErrorBoundary extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            error: false,\n            info: null\n        };\n    }\n\n    componentDidCatch(error, info) {\n        this.setState({\n            error: error,\n            info: info\n        });\n    }\n\n    render() {\n        if (this.state.error) {\n            return (\n                <Container fluid={true}>\n                    <Row className=\"vcenter\">\n                        <Col lg={12} className=\"h1 text-center\">\n                            Oops! Something went wrong!\n                        </Col>\n                    </Row>\n                </Container>\n            );\n        }\n\n        return this.props.children;\n    }\n}\n","import { DATA_LOADED } from '../actions/Types';\n\nconst initialState = {\n    dataLoaded: false,\n    people: [],\n    facts: [],\n    places: {}\n};\n\nexport default function(state = initialState, action) {\n    switch (action.type) {\n        case DATA_LOADED:\n            return {\n                ...state,\n                dataLoaded: true,\n                people: action.data.people,\n                facts: action.data.facts,\n                places: action.data.places\n            };\n        default:\n            return state;\n    }\n}\n","import { SET_ROOT, SET_VIEW } from '../actions/Types';\n\nconst initialState = {\n    rootId: 2,\n    view: 'TREE'\n};\n\nexport default function(state = initialState, action) {\n    switch (action.type) {\n        case SET_ROOT:\n            return {\n                ...state,\n                rootId: action.data.rootId,\n                view: initialState.view\n            };\n        case SET_VIEW:\n            return {\n                ...state,\n                view: action.data.view\n            };\n        default:\n            return state;\n    }\n}\n","import {\n    SET_DISPLAYED_DETAILS,\n    SET_RESOURCE_PREVIEW,\n    GALLERY_TOGGLED,\n    SET_GALLERY_INDEX,\n    SET_GALLERY_SCALE\n} from '../actions/Types';\n\nconst initialState = {\n    personId: null,\n    person: null,\n    facts: null,\n    currentResource: null,\n    currentFact: null,\n    showGallery: false,\n    galleryItems: null,\n    galleryIndex: null,\n    galleryScale: 0\n};\n\nexport default function(state = initialState, action) {\n    switch (action.type) {\n        case SET_DISPLAYED_DETAILS:\n            return {\n                ...state,\n                personId: action.data.personId,\n                person: action.data.person,\n                facts: action.data.facts,\n                currentResource: action.data.currentResource,\n                currentFact: action.data.currentFact,\n                showGallery: false,\n                galleryItems: action.data.galleryItems\n            };\n        case SET_RESOURCE_PREVIEW:\n            return {\n                ...state,\n                currentResource: action.data.resource,\n                currentFact: action.data.fact\n            };\n        case GALLERY_TOGGLED:\n            return {\n                ...state,\n                showGallery: !state.showGallery,\n                galleryIndex: action.data.index\n            };\n        case SET_GALLERY_INDEX:\n            return {\n                ...state,\n                galleryIndex: action.data.index,\n                galleryScale: 1\n            };\n        case SET_GALLERY_SCALE:\n            return {\n                ...state,\n                galleryScale: action.data.scale\n            };\n        default:\n            return state;\n    }\n}\n","import { SEARCH_OPTIONS } from '../actions/Types';\n\nconst initialState = {\n    options: []\n};\n\nexport default function(state = initialState, action) {\n    switch (action.type) {\n        case SEARCH_OPTIONS:\n            return {\n                ...state,\n                options: action.data.options\n            };\n        default:\n            return state;\n    }\n}\n","import { combineReducers } from 'redux';\nimport dataRepositoryReducer from './DataRepositoryReducer';\nimport treeReducer from './TreeReducer';\nimport detailsReducer from './DetailsReducer';\nimport searchReducer from './SearchReducer';\n\nexport default combineReducers({\n    dataRepository: dataRepositoryReducer,\n    tree: treeReducer,\n    details: detailsReducer,\n    search: searchReducer\n});\n","import { createStore, applyMiddleware, compose } from 'redux';\nimport thunk from 'redux-thunk';\nimport rootReducer from './reducers';\n\nconst initialState = {};\n\nconst middleware = [thunk];\n\nconst composeEnhancers =\n    (window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ &&\n        window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({\n            trace: true,\n            traceLimit: 25\n        })) ||\n    compose;\n\nconst store = createStore(\n    rootReducer,\n    initialState,\n    composeEnhancers(applyMiddleware(...middleware))\n);\n\nexport default store;\n","import React from 'react';\nimport FamilyTree from './presentation/FamilyTree';\nimport ErrorBoundary from './ErrorBoundary';\nimport { Provider } from 'react-redux';\nimport store from './state/Store';\n\nexport default class App extends React.Component {\n    render() {\n        return (\n            <Provider store={store}>\n                <ErrorBoundary>\n                    <FamilyTree />\n                </ErrorBoundary>\n            </Provider>\n        );\n    }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './css/familytree.css';\nimport App from './components/App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}